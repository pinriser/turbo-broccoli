import { useState } from 'react'
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Label } from "@/components/ui/label"
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select"
import { Vulnerability } from '../types'

interface VulnerabilityFormProps {
  onSubmit: (vulnerability: Vulnerability) => void
}

export function VulnerabilityForm({ onSubmit }: VulnerabilityFormProps) {
  const [vulnerability, setVulnerability] = useState<Vulnerability>({
    id: '',
    name: '',
    severity: 'Low',
    status: 'Open',
    discoveredAt: new Date().toISOString(),
    remediatedAt: null,
  })

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault()
    onSubmit({ ...vulnerability, id: Date.now().toString() })
    setVulnerability({
      id: '',
      name: '',
      severity: 'Low',
      status: 'Open',
      discoveredAt: new Date().toISOString(),
      remediatedAt: null,
    })
  }

  return (
    <form onSubmit={handleSubmit} className="space-y-4 mb-8">
      <div>
        <Label htmlFor="name">Vulnerability Name</Label>
        <Input
          id="name"
          value={vulnerability.name}
          onChange={(e) => setVulnerability({ ...vulnerability, name: e.target.value })}
          required
        />
      </div>
      <div>
        <Label htmlFor="severity">Severity</Label>
        <Select
          value={vulnerability.severity}
          onValueChange={(value) => setVulnerability({ ...vulnerability, severity: value as Vulnerability['severity'] })}
        >
          <SelectTrigger>
            <SelectValue placeholder="Select severity" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="Low">Low</SelectItem>
            <SelectItem value="Medium">Medium</SelectItem>
            <SelectItem value="High">High</SelectItem>
            <SelectItem value="Critical">Critical</SelectItem>
          </SelectContent>
        </Select>
      </div>
      <div>
        <Label htmlFor="status">Status</Label>
        <Select
          value={vulnerability.status}
          onValueChange={(value) => setVulnerability({ ...vulnerability, status: value as Vulnerability['status'] })}
        >
          <SelectTrigger>
            <SelectValue placeholder="Select status" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="Open">Open</SelectItem>
            <SelectItem value="In Progress">In Progress</SelectItem>
            <SelectItem value="Resolved">Resolved</SelectItem>
          </SelectContent>
        </Select>
      </div>
      <Button type="submit">Add Vulnerability</Button>
    </form>
  )
}

